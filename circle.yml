## Customize the test machine
machine:
  services:
    - docker

  timezone:
    Europe/Sofia # Set the timezone

  # Version of ruby to use
  ruby:
    version:
      2.3.0
  java:
    version: oraclejdk8

  # Add some environment variables
  environment:
    ORACLE_COOKIE: sqldev
    ORACLE_FILE: oracle11g/xe/oracle-xe-11.2.0-1.0.x86_64.rpm.zip
    ORACLE_HOME: /u01/app/oracle/product/11.2.0/xe
    NLS_LANG: AMERICAN_AMERICA.AL32UTF8
    ORACLE_BASE: /u01/app/oracle
    LD_LIBRARY_PATH: $ORACLE_HOME/lib
    PATH: $PATH:$ORACLE_HOME/jdbc/lib
    DATABASE_VERSION: 11.2.0.2
    ORACLE_SID: XE
    DATABASE_NAME: XE
    ORA_SDTZ: 'Europe/London'
    TZ: 'Europe/London'


## Customize dependencies
dependencies:
  pre:
    - rvm install 2.3.0
    - rvm install jruby-9.0.5.0
  override:
    # - docker info
    # - docker pull wnameless/oracle-xe-11g
    # - docker run -d -p 49160:22 -p 49161:1521 wnameless/oracle-xe-11g
    - .travis/oracle/download.sh
    - .travis/oracle/install.sh
    - .travis/setup_accounts.sh
    - rvm-exec 2.3.0 bash -c "gem install ruby-oci8"

test:
  override:
    - rvm-exec 2.3.0         bash -c "bundle install; bundle exec rake test"
    - rvm-exec jruby-9.0.5.0 bash -c "bundle install; bundle exec rake test"

